%% 
%% Copyright 2019-2024 Elsevier Ltd
%% 
%% This file is part of the 'CAS Bundle'.
%% --------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.3c of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.3c or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'CAS Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for cas-dc documentclass for 
%% double column output.

\documentclass[a4paper,fleqn]{cas-dc}

% If the frontmatter runs over more than one page
% use the longmktitle option.

%\documentclass[a4paper,fleqn,longmktitle]{cas-dc}

%\usepackage[numbers]{natbib}
%\usepackage[authoryear]{natbib}
\usepackage[authoryear,longnamesfirst]{natbib}

%%%Author macros
\def\tsc#1{\csdef{#1}{\textsc{\lowercase{#1}}\xspace}}
\tsc{SCM}
\tsc{EL}
\tsc{SC}
\tsc{CFB}
%%%

% Uncomment and use as if needed
%\newtheorem{theorem}{Theorem}
%\newtheorem{lemma}[theorem]{Lemma}
%\newdefinition{rmk}{Remark}
%\newproof{pf}{Proof}
%\newproof{pot}{Proof of Theorem \ref{thm}}

\begin{document}
\let\WriteBookmarks\relax
\def\floatpagepagefraction{1}
\def\textpagefraction{.001}

% Short title
\shorttitle{T-reX\@: Quantifying waste and material footprints in LCA}    

% Short author
\shortauthors{S.C. McDowall et~al.}  

% Main title of the paper
\title [mode = title]{T-reX\@: Quantifying waste and material footprints in current and future \\ Life Cycle Assessment (LCA) databases}  

% Authors
\author[1]{Stewart Charles McDowall}
\ead{s.c.mcdowall@cml.leidenuniv.nl}
\cormark[1]
\cortext[cor1]{Corresponding author:}

\author[1]{Elizabeth Lanphear}

\author[1]{Stefano Cucurachi}

\author[1]{Carlos Felipe Blanco}

\affiliation[1]{
    organization={Institute of Environmental Sciences (CML), Leiden University},
    addressline={P.O. Box 9518},
    city={Leiden},
    postcode={2300 RA},
    state={South Holland},
    country={The Netherlands}}


% Abstract
\begin{abstract}

%? reviewer 2 - comment 2 - simplify language
The quintessential principle of the circular economy is to minimise material consumption and waste generation. Thus, identifying and quantifying waste and material flows is critical. Life Cycle Assessment (LCA) is a powerful method, given its capacity to pinpoint hotspots of environmental impact throughout an activity's life cycle, where the implementation of circular principles could be most effective.

We introduce T-reX, a Python tool extending the brightway ecosystem to allow facile quantification of user-defined supply chain demands in current and prospective scenarios. T-reX streamlines database manipulation for LCA practitioners and integrates methods to aggregate and analyse waste and material flows, facilitating rapid hotspot identification.

A case study of five lithium-ion batteries demonstrates T-reX's utility, quantifying categorised waste and material inventory footprints and their potential environmental burdens. T-reX can aid sustainable decision-making and contribute to the development of a `circular economy' by facilitating analysis of material consumption and waste generation in LCA.

\end{abstract}

% Keywords
\verb+\begin{keyword}+ \verb+circular economy+ \verb+waste+ \verb+material+ \verb+life cycle assessment+ \verb+critical raw material+ \verb+supply chain+ \end{keyword}

% Graphical abstract
\begin{graphicalabstract}
  \includegraphics{figs/cas-grabs-TREX.pdf}
\end{graphicalabstract}

% Highlights
\begin{highlights}
    \item T-reX, a new open-source program for quantifying waste and material flows in Life Cycle Assessment (LCA)
    \item Assesses supply risks by calculating demand inventories for critical materials
    \item Simplifies quantification of user-specified waste and material footprint categories
    \item Rapidly identifies hotspots of waste generation and material demand in supply chains
    \item Presents a case study of five lithium-ion batteries to demonstrate T-reX's utility
\end{highlights}

% Keywords
\begin{keyword}
  circular economy \sep{}waste \sep{}material \sep{}life cycle assessment \sep{}critical raw material \sep{}supply chain
\end{keyword}

%\nocite{*}

\maketitle


% list of abbreviations
\begin{table}[H]
  \centering
  \caption*{List of abbreviations and terminology}\label{tab:abbreviations}
  \begin{tabular}{ll}
      \toprule
      %? reviewer 3 - RE: CCS definition
      CCS              & Carbon Capture and Storage                                           \\
      CF                & Carbon Footprint                                                    \\
      EF                & Ecological Footprint                                                \\
      CML               & Centrum voor Milieuwetenschappen (Centre for Environmental Science) \\
      CRM               & Critical Raw Material                                               \\
      CPC               & Cooperative Patent Classification                                   \\
      CSI               & Crustal Scarcity Indicator                                          \\
      CSP               & Crustal Scarcity Potential                                          \\
      EDIP              & Environmental Design of Industrial Products                         \\
      EEIOA             & Environmentally Extended Input-Output Analysis                      \\
      EOL               & End-of-Life                                                         \\
      FOEN              & Swiss Federal Office for the Environment                            \\
      IAM               & Integrated Assessment Model                                         \\
      IE                & Industrial Ecology                                                  \\
      LCA               & Life Cycle Assessment                                               \\
      LCI               & Life Cycle Inventory                                                \\
      LCIA              & Life Cycle Impact Assessment                                        \\
      LFP               & Lithium Iron Phosphate                                              \\
      Li-ion            & Lithium-ion                                                         \\
      LiMn\(_2\)O\(_4\) & Lithium Manganese Oxide                                             \\
      MF                & Material Footprint                                                  \\
      MFA               & Material Flow Analysis                                              \\
      NCA               & Nickel Cobalt Aluminum                                              \\
      NMC               & Nickel Manganese Cobalt                                             \\
      PWF               & Product Waste Footprint                                             \\
      RCP               & Representative Concentration Pathway                                \\
      ReCiPe            & A standard LCIA method set                                          \\
      SDG               & Sustainable Development Goals                                       \\
      SSPs              & Shared Socioeconomic Pathways                                       \\
      T-reX             & The Tool for analysing re-X in LCA                                  \\
      UBP               & Umweltbelastungspünkte (Environmental Impact Points)                \\
      UN                & United Nations                                                      \\
      WF                & Waste Footprint                                                     \\
      \bottomrule
  \end{tabular}
\end{table}


% Main text

% Introduction
\section{Introduction}\label{sec:introduction}
\subsection{Introduction to T-reX}\label{sec:intro-trex}

%? reviewer 2 - comment 2 - simplify language
Development of a circular economy has become a central focus in the pursuit of sustainability objectives toward curtailment of our environmental footprint within planetary boundaries~\citep{eu2019greendeal, eu2020circ,nl2023ceplan,nl2016ceplan,pardo2018ce,ellenmacarthur2015ce}. Fundamental to this development is a decrease in primary material consumption and a reduction of life cycle waste through the implementation of `re-X' strategies (e.g., refuse, rethink, design for---and implementation of---repair, remanufacturing and recycling)~\citep{reike2018rex, eu2022ecodesign, eu2022repair, eu2015reman}. In addition to circular economy goals, contemporary geopolitical tensions in an ever more globalised economy have highlighted the vulnerability of many advanced economies to intentional supply disruptions---wrought as an act of competition or even outright hostility~\citep{jrc2023supplychain,hartley2024cepolitics,berry2023crm}.

The concept of the `footprint' as an environmental sustainability indicator began with the Ecological Footprint (EF)~\citep{wackernagel1994ecologicalfootprint} and after being popularised by the Carbon Footprint (CF)~\citep{cucek2015environmentalfootprints} the `footprint family' has adopted many additional metrics---albeit without yet coalescing into a coherent or consistent framework~\citep{giampietro2014footprintstonowhere, vanham2019footprints,ridoutt2013footprints}. More recently, the footprint collection has been extended to include the Material Footprint (MF)~\citep{weidmann2013materialfootprint}, which is often encountered in the `macro methods' of Industrial Ecology (IE), such as environmentally Extended Input-Output Analysis (EEIOA)~\citep{lenzen2022materialfootprint} and Material Flow Analysis (MFA)~\citep{schaffartzik2013mfafootprint}. Whether at the level of products, entire industries, nations, or even continents, the material footprint aims to quantify the total material consumed in supply chains. It has been shown that the MF can be `highly representative of damage to human health and biodiversity'~\citep{steinmann2017resourcefootprints} and indeed, this metric was recently beatified by the United Nations (UN), becoming the `core official indicator' for targets 8.4 and 12.2 of the Sustainable Development Goals (SDGs)~\citep{lenzen2022materialfootprint}.

Though steadily emerging~\citep{laurenti2016wastefootprint,demirer2019wastefootprint,guillotreau2023wastefootprint}, the `Waste Footprint' (WF) metric is less well-developed. While it seems obvious that reducing life cycle waste is critical to the development of the circular economy~\citep{towa2020wastefootprint,ellenmacarthur2015ce}, the WF remains largely overlooked---especially in LCA models where waste itself is seldom apportioned any inherent environmental significance aside from the emissions related to its treatment~\citep{laurenti2023wastefootprint}. Such neglect strikes the authors as unjustified, given that it has been repeatedly demonstrated that WFs have a strong association with environmental damage~\citep{laurenti2023wastefootprint,doka2024publications, ridoutt2010wasteimpacts,jaio2013wasteabsorbtionfootprint}. Additionally, it has been shown that the most vulnerable communities suffer disproportionately from the social and ecological impacts created by wasteful behaviours and substandard end-of-life treatment~\citep{pellow2023envjusticewaste,akese2018envjustice}.

WF and MF, the two metrics of focus in the study, can provide a comprehensive assessment of potential environmental impacts across the supply chain, encapsulating both resource use and pollution/waste generation, while offering insights at diverse scales, from individual activities to global systems, facilitating communication with a diverse range of stakeholders. Thus, to reduce the negative externalities of human consumption and improve supply chain resilience, it is essential to uncover, disaggregate, and quantify the material and waste footprints of human activities in as much detail as possible~\citep{bisinella2024wastelca, towa2020wastefootprint,berger2020mineralsinlca,sonderegger2020mineralsinlca}.

%? reviewer 2 - comment 1 - COMPARISON OF T-REX TO OTHER TOOLS
%! fix
Life Cycle Assessment (LCA) is a useful method for the holistic estimation of the environmental impacts of products and processes. LCA can comprehensively evaluate impacts across the entire life cycle---from `cradle to grave'--- often identifying critical hotspots and guiding prioritisation of action~\citep{guinee2011lca}. The standard approach is to apply Life Cycle Impact Assessment (LCIA) methods (such as ReCiPe~\citep{huijbregts2016recipe} and CML~\citep{guinee2002cml}), which convert the inventory data into a set of impact scores based on the sum of the elementary flows (those between the technosphere and biosphere). These scores can then be aggregated into one metric for each impact category that can be compared across products and processes. Extending on standard LCA is \textit{ex-ante} LCA, which employs future scenarios to construct `prospective background databases' to predict the impacts of supply chains that have not yet been (and may never be) realised~\citep{cucurachi2018exante,blanco2020exante}.

Several LCIA methods include, to some extent, waste generation (Swiss Eco-Factors, EDIP and EN15804)~\citep{foen2021ecofactors,hauschild2003edip,cen2019en15804} and material consumption (Crustal Scarcity Indicator (CSI) and Swiss Eco-Factors~\citep{arvidsson2020csi,foen2021ecofactors}). These methods, however, are generally limited in their scope (especially for waste), do not allow for flexible quantification of specific waste and material types, and often provide results in characterised units that are abstract or difficult to interpret (e.g., \textit{Ümweltbelastungspunkte} (UBP) [English: environmental impact points] in the case of the Swiss Eco-Factors)~\citep{su2020sustainableproddev}.

To facilitate the quantification of waste and material flows in LCA, we developed a Python package to extend the \texttt{brightway} open-source LCA framework~\citep{mutel2017brightway} and track these exchanges by translating them into inventory indicators and `pseudo' LCA impact (LCIA) categories. T-reX is `T(ool for) re-X' (reduce, reuse, recycle, etc...) and enables LCA practitioners to manipulate their databases to allow them to easily aggregate the mass and volume of any desired exchange, and to create flexible categories that differentiate between material categories, waste types, and treatment or EOL handling.

Integration with the \texttt{premise} Python package~\citep{sacchi2022premise}---which connects the projections of integrated assessment models (IAMs) with current LCA databases---enables the user to create and manipulate prospective LCA databases. Frustratingly, the current utility of prospective databases---in general, and in particular for the waste sector---is constrained by the fact that, to date, the sectoral coverage of future life cycle inventories (LCIs) is largely confined to energy, steel, cement, and transport~\citep{sacchi2023premisedocs}. Despite the ever more critical need to reliably model and future waste management systems,~\cite{bisinella2024wastelca} reports an alarming lack of coherent development in this field. \texttt{premise} offers an excellent structure for the integration of future waste and material flow modelling in LCA databases, but its potential contribution to the development of the circular economy cannot be realised if the scientific resources for data collection and validation are not forthcoming. The authors believe that there is an urgent need for research investment in this area.

%! reviewer 3 - comment 1 - ADDITIONAL INFORMATION ON T-REX's differentiating features comparet to LCI
The purpose of T-reX is not to quantify the environmental impacts of material consumption and waste production (the requisite data and impact modelling remain lacking), but rather to quantify the material and waste flows themselves, even those that are finally consumed by waste treatment processes. It provides, thus, not an impact assessment in the traditional sense, but an accounting of the material consumed and waste generated by a product or service inside of the technosphere, regardless of the end-of-life fate of these flows. By definition, the development of the `circular economy' necessitates the reduction and ultimate elimination of waste (though whether this objective is thermodynamically impossible has long been the subject of debate by~\cite{ayres1998recycling},~\cite{reuter2012recyclinglimits} and many others). In any case, minimising primary material consumption and the generation of waste is of paramount importance. By allowing LCA practitioners to easily classify and quantify these exchanges, T-reX provides a practical means to identify hotspots and potentially highlight opportunities for waste reduction and material efficiency. 

%? reviewer 2 - comment 3 - ADDITIONAL INFORMATION ON T-REX's FUTURE DEVELOPMENT
With the continual improvement of LCA databases and the development of prospective databases, T-reX can produce ever more realistic estimates, enhancing its actionable utility derived from the exploration of the potential impacts of future waste management systems and the material demands of emerging technologies. The better the data, the more specific and accurate the results of T-reX analysis, and, thus, the more useful the tool becomes. The authors hope that T-reX will be a valuable asset to the LCA community and contribute to the development of a more sustainable and circular economy.

\subsection{Background and need}\label{sec:intro-background}

\subsubsection{Waste in LCA}\label{sec:intro-waste}

Though often described simply as a `material with a negative economic value'~\citep{guinee2004economicallocation}, waste is a nebulous concept, and one whose definition is poorly delineated and highly variable across space and time. From a systems perspective, the notion of waste is anathema to the `circular economy', they cannot co-exist. From a practical economic viewpoint, the viability of an extensive waste processing system is highly dependent on precise knowledge (or at least, reasonable predictions) of material and waste flows, in addition to energy costs and the relative prices of virgin and secondary materials. Thus, as~\cite{bisinella2024wastelca} argues, waste must be `thoroughly characterised' and `modelling [of its management] must be physically based'. The reliable, robust models needed to guide the development of the circular economy can be built only on a foundation of high-quality data.

Accurate and detailed information about waste and waste systems is, by definition, essential for understanding the `circularity' of a human activity and for predicting its life cycle externalities. There remains, however, a knowledge gap regarding WFs and their associated environmental impacts~\citep{laurenti2023wastefootprint}.

Conventional LCA database models consider waste as a `service' (accounting for the treatment, not the material)~\citep{guinee2021wasteisnotaservice} and typically use generic waste processing models~\citep{beylot2018} that break the causal link between the functional unit and the waste-associated impacts. In LCA, waste flows are (almost exclusively) not considered as fundamental biosphere exchanges, but rather, as technosphere flows within the human economy. Waste produced by an activity is transferred to a relevant waste treatment activity where it is accepted `burden-free' and transformed into a combination of emissions and other waste `products'~\citep{guinee2021wasteisnotaservice}. There can be several treatment steps in this pathway leading, ultimately, to a mass of material being deposited in a landfill. In this system of waste accounting, the impacts apportioned to the waste-producing activity are a sum of those incurred by the transport, treatment, and final disposal of the waste into terrestrial or aquatic environments. In particular, the extensive work of~\cite{doka2024publications} has contributed significantly to understanding the environmental impacts of waste treatment processes and the modelling of the long-term impacts of disposal.

A considerable portion of a product's total waste is generated during earlier stages of its supply chain such as resource extraction, transportation, and manufacturing, thus, often remaining `invisible' to conventional LCA accounting practices~\citep{laurenti2016wastefootprint}. This oversight in measuring and communicating a cradle-to-grave product waste footprint (PWF) highlights a gap in circular economy indicators. Traditional LCA does not typically view waste as having environmental significance \textit{per se}, considering instead only emissions and resource use resulting from waste treatment~\citep{bisinella2024wastelca, laurenti2023wastefootprint}. The environmental significance of waste and its correlation with other indicators has been the subject of extensive research. Studies have shown that popular resource footprints can cover a significant portion of environmental impact variance between activities~\citep{steinmann2017resourcefootprints,laurenti2023wastefootprint}. Correlations between various environmental indicators are not always consistent, however, as seen with the carbon footprint, which often does not correlate well with other impact assessment scores~\citep{laurenti2012carbonfootprint}. The aggregation of waste in PWFs raises concerns among LCA experts, regarding the uncertainties introduced, as well as the potential misrepresentation of environmental performance due to differences in waste types~\citep{chen2021methoduncertainty,huijbregts2010energyfootprint}.

Some existing LCA methodologies offer direct indicators at the impact assessment level, but generally, there is little attention given to the impacts of waste in LCA~\citep{lauran2020abioticdepletion}. This limitation becomes particularly evident when attempting to identify waste generation hotspots within a product's life cycle. Addressing these hotspots is crucial for advancing `circularity', but there is a lack of convenient and flexible methods to calculate waste flows in LCA and a pressing need for more comprehensive methods that can effectively quantify waste flows and, therefore, contribute to a greater understanding of a product's total environmental footprint.

~\cite{laurenti2023wastefootprint} developed a method to calculate the waste footprint of a product or service based on solving the demand vectors of the activities, while also proposing simple measures to quantify waste `hazardousness' and `circularity' with this data. The method presented, as the authors explain, suffers from errors due to double counting due to the way that exchanges are identified and `tagged' . In T-reX, the source database is deconstructed into a list of separate exchanges, and only those explicitly defined as hazardous are marked as such. The `T-reX' Python software tool presented herein provides a more flexible, transparent, and user-friendly approach to quantifying waste flows in LCA\@. Moreover, the utility of T-reX is not limited to waste, it can be used to categorise and aggregate any technosphere exchange of interest (or customised grouping thereof), such as water, gas, and critical raw materials.

\subsubsection{Material demand in LCA}\label{sec:intro-material}

In the context of geopolitical tension and a mineral-hungry `renewable energy transition', greater attention is being given to the security of material supply---especially for those considered `critical raw materials' (CRMs)~\citep{eu2023crmstudy,hool2023crm,mancini2013supplysecurity,jrc2023supplychain,hartley2024cepolitics,salviulo2021supplychain,iea2023crm,iea2023energytechperspectives}. While LCA seeks to model the technosphere (a.k.a.\ the anthroposphere) and its exchanges with the biosphere, its focus is often on the environmental impacts of the system rather than the primary material flows themselves.

The Crustal Scarcity (CSI) LCIA method was developed in order to introduce an assessment of the long-term global scarcity of minerals in LCA~\citep{arvidsson2020csi}. The CSI introduced crustal scarcity potentials (CSPs), which are measured in kg--silicon--equivalents per kg--element and derived from crustal concentrations. CSPs, provided for 76 elements, reflect the long-term global elemental scarcity based on crustal concentration proxies. The CSI, calculated by multiplying CSPs with extracted masses, effectively gauges the impact of elemental extraction.

While useful for its intended purpose, the CSI presents its results in an abstract unit (kg-Si eq.) that is difficult to interpret and compare with other impact categories. Furthermore, the CSPs are not available for all elements (or more complex materials), and the method does not allow for the quantification of material demands in terms of mass or volume.

% Methodology

\section{Methodology}\label{sec:methodology}

This section is divided into two parts. In \autoref{sec:method-TreX}, we describe the T-reX program, and in \autoref{sec:method-casestudy}, we describe the methodology used to calculate the waste and material inventory footprints in a case study of five Li-ion batteries, highlighting inconsistencies in LCA methodology and probing departures from projections in prospective models.

\subsection{T-reX}\label{sec:method-TreX}

\subsubsection{Computational framework}

Developed in the Python programming language, T-reX extends the \texttt{brightway LCA framework}, utilising especially  the components \texttt{bw2data}, \texttt{bw2calc}, and \texttt{bw2io}~\citep{mutel2017brightway}. Additionally, the \texttt{wurst} package---which can deconstruct databases into a list of exchanges---is used to facilitate searching and data transformation at the exchange level (the individual supply chain flows)~\citep{mutel2017wurst}. Integration with the \texttt{premise} package~\citep{sacchi2022premise}---which integrates the projections of integrated assessment models (IAMs) into current LCA databases---enables the user to easily create and manipulate prospective LCA databases. T-reX is also compatible with \texttt{ActivityBrowser}~\citep{steubing2020activitybrowser}---an open-source graphical user interface for LCA---and after running T-reX, the manipulated databases and the `pseudo-LCIA' methods created by T-reX can be used in the project in the accustomed way. T-reX is installable via the Python Package Index (PyPI)~\citep{mcdowall2023T-reXpipy} and is fully open-source under the CC-0 licence. The full source code for T-reX is indexed on Zenodo~\citep{mcdowall2023T-reXzenodo} and under further development in the GitHub repository~\citep{mcdowall2024T-reXgithub}. T-reX is designed to be used with \texttt{ecoinvent} databases~\citep{ecoinvent2016version3}, but could be adapted to other databases by changing the search criteria. Currently, it has been tested with all available system models of \texttt{ecoinvent}versions 3.5--3.10.

T-reX can be used directly from the command line, or imported as a Python package with which the user can access the individual functions and modules. In the simplest case, the user can run the program with the default settings, which will calculate the waste and material footprint of the \texttt{ecoinvent}database. The user can adapt the settings of T-reX as desired, to calculate alternative or additional waste and material inventory footprints, use a custom database, or a `prospective' database based on future scenarios by implementing the premise \texttt{premise} with one of T-reX's internal modules.

The supplementary material in \autoref{sec:supplementary} contains metadata of T-reX, along with a list of the constituent modules, a description of their functions, and a detailed computational workflow. Further details can be found in the GitHub repository and package documentation~\citep{mcdowall2024T-reXgithub, mcdowall2023T-reXdocs}.

\subsubsection{Functionality and purpose}

T-reX is a Python package that enables one to produce LCA databases---both current and prospective---that are manipulated to facilitate the calculation of waste and material inventory footprints in the supply chain of any activity in the same way as one would apply standard LCIA methods. We refer to the T-reX methods as `pseudo-LCIA' methods, as they represent an accounting of an activity's technosphere inventory without reference to impact modelling, as in standard LCIA.

If desired, prospective databases can be defined by the user or constructed with the projections of the integrated assessment models such as IMAGE~\citep{stehfest2014image} and REMIND~\citep{remind2020model}, which offer a range of options aligned with the Shared Socioeconomic Pathways (SSPs)~\citep{ssp2020ghg} and can be paired with a variety of mitigation scenarios.

The deconstruction of the databases by T-reX into lists of exchanges allows the relevant flows of material and waste to be identified and categorised by the search functions. The queries facilitating this are tailored to the specific database and the user can easily modify them to suit their needs. The categories defined in the configuration are used to create T-reX's `pseudo LCIA' methods that are indicators of aggregated technosphere demand. The exchange editing function of T-reX then takes each list of exchanges and appends to the relevant activity a copy of the technosphere exchange as a mirrored `pseudo-biosphere' exchange that matches the `pseudo-LCIA' method.

In the default configuration of T-reX, there are 10 waste categories which are then further divided by their unit of measurement (kilograms and cubic meters) to create a total of 20 waste methods. The waste categories include aggregations such as 'total waste', 'hazardous waste' as well as, those for waste sent to treatment by, for example, incineration or recycling. The full details are listed in the supplementary material in~\autoref{sec:supplementary} [section 3 ]. One advantage of T-reX is that it can identify `hidden' waste exchanges that would otherwise be `consumed' by a treatment process and not leave the technosphere.

In addition to these waste categories, T-reX can incorporate any number of material demand categories, the defaults being based on the EU Critical Raw Materials (CRM) list for 2023~\citep{eu2023crmstudy}, which contains 30 materials considered essential to the EU economy and also at risk of supply disruption. Especially valuable in the case of CRMs is T-reX's ability to uncover and quantify these threads of background consumption, which can be inconspicuously embedded in products or consumed in seemingly distant supply chain activities. The identity of the materials considered, and their categorical groupings, are easily customisable by the user. The full list of 59 materials included in the default configuration is provided in the supplementary material in~\autoref{sec:supplementary}.

Following the logic of the standard LCA models \cite{ecoinvent2016version3, guinee2004economicallocation}, the logic for the identification of material exchanges with T-reX differs from that used to identify waste exchanges in that the search queries are based on the names of the relevant `market activities' for the material of interest rather than keywords in the exchange's name. A useful feature of T-reX is that, in cases where there are several markets for one material or material group, the program can aggregate these flows. For example, exchanges with markets for the rare-earth-elements (REEs) `market for cerium', `market for dysprosium', `market for erbium', etc.\ can be aggregated into a single indicator category for REEs. Similarly, the total demand for all critical raw materials (CRMs) can be calculated in the same manner.

In these methods, the material demand is calculated based on the total mass that is extracted from the environment, thus, their focus is essentially solely on the mining-related exchanges that bring these materials from the biosphere into the technosphere.

T-reX, in contrast, uses accounting for material demand and waste generation based on exchanges solely within the technosphere, a material basis. This offers a different perspective, allowing for the estimation of overall supply chain material demands that consider the entire life cycle of an activity, including non-direct effects on the market, such as a 'negative consumption' of other materials due their co-production with the functional unit. Consider a demand for an activity containing a metal, for example; while the existing material use methods allow one to calculate the total mass of that metal that is extracted from the environment, T-reX can provide insight into the broader supply chain impacts of the demand for this metal. If the production of other materials is attributed to the production of this metal, these would appear as negative material demands in the T-reX results---supply chain pressure for one material can result in lessening of supply chain pressure for another. For example, in the results of the Li-ion battery case study , this is indeed the case for nickel demand, which, in the final inventory because of such co-production, is counter-intuitively negative (due to co-production and substitution in the LCA system models) despite the presence of nickel in the final products.

\subsubsection{The workflow of T-reX}

The workflow of T-reX is divided into several modules, each performing a separate function. The modules are designed to be used in a particular order, but the user can also use them individually to perform specific tasks. The standard workflow is as follows:

\begin{enumerate}
    \item Configuration of waste and material exchange categorisation (optional)
    \item Generation of prospective LCA databases (optional)
    \item Database expansion---to create a list of all exchanges in the database
    \item Identification and categorisation of exchanges
    \item Creation of `pseudo-biosphere' databases
    \item Creation of `pseudo-LCIA' methods to calculate waste and material inventory footprints
    \item Exchange editing---whereby the technosphere exchange is mirrored as a `pseudo-biosphere' exchange
    \item Database verification---to ensure that T-reX has manipulated the database correctly
\end{enumerate}

This workflow creates a copy of the original \texttt{brightway} project containing the original biosphere database, a T-reX `pseudo-biosphere' database along with one or more manipulated technosphere databases that can be used to calculate the waste and material inventory footprints of activities in the same way as standard LCIA calculations.

An overview of the T-reX workflow is presented in \autoref{fig:methods-flowchart}. The supplementary material in \autoref{sec:supplementary} contains a more detailed computational flowchart.

\begin{figure}[H]
    \centering
    \caption{The workflow of T-reX presented in a generalised (a) and computational (b) format. Application of T-reX to one or more LCA databases creates a \texttt{brightway} project with customised methods and activities that can be used to calculate waste and material inventory footprints of the activity's supply chain.}
    \includegraphics[width=9cm]{figures/T-reX_method.pdf}\label{fig:methods-flowchart}
\end{figure}


\subsection{Case study methodology}\label{sec:method-casestudy}

To provide an example, we investigated five types of Li-ion batteries in the \texttt{ecoinvent} 3.9.1 `cutoff' LCA database~\citep{ecoinvent2016version3}, each represented by their unamended global market inventories. The system boundaies. These following markets were used for the example calculations and unaltered by the authors:
\begin{itemize}[itemsep=0pt]
    \item Li-ion, LFP, rechargeable, prismatic
    \item Li-ion, LiMn\(_2\)O\(_4\), rechargeable, prismatic
    \item Li-ion, NMC111, rechargeable, prismatic
    \item Li-ion, NMC811, rechargeable, prismatic
    \item Li-ion, NCA, rechargeable, prismatic
\end{itemize}

In addition to the waste and material inventory footprint methods created by T-reX, the following standard LCIA methods were applied for comparison:

\begin{itemize}[itemsep=0pt]
    \item ReCiPe 2016 v1.03, midpoint (I)~\citep{huijbregts2016recipe}
    \item Environmental Footprint (EF) v3.1 (no long-term emissions)~\citep{eu2023ef}
    \item Spatial differentiation in life cycle impact assessment---the EDIP 2003 no long term emissions method~\citep{hauschild2003edip}
    \item The crustal scarcity indicator method---CSI 2020~\citep{arvidsson2020csi}
\end{itemize}

Additional to the present-day databases, T-reX created prospective database sets based on \texttt{ecoinvent} 3.9.1 using the functionality of \texttt{premise} with the REMIND model and the baseline scenario SSP2 `middle of the road' with the following Representative Concentration Pathways (RCPs):
\begin{itemize}
    \item SSP2-base: representing an approximate 3.5°C increase in global temperatures to 2100
    \item SSP2-PkBudg500: representing the achievement of Paris climate goals, ca. 1.3°C increase to 2100
\end{itemize}

For each pathway, databases (at five-year time intervals) were created with \texttt{premise}~\citep{sacchi2022premise} and processed with T-reX for the period between 2020 and 2100.

\subsubsection{LCA calculations}
For each combination of activity, method, and database, a unified metric was calculated along with details of the top contributing processes. Additionally, for the T-reX methods, a contribution analysis was performed. Utilising the \texttt{bwa.compare\_activities\_by\_grouped\_leaves} function from the \texttt{brightway2\_analyzer} package~\citep{mutel2016brightway2analyzer}, a component of the \texttt{brightway} ecosystem, this function performs one subjective method of graph traversal on the impact matrix of the LCA object to a specified cutoff. The groups of the resulting leaves are collected by their Cooperative Patent Classification (CPC) codes [giving a representation of industry sector involvement]. T-reX provides, essentially, a tabulation of internal exchanges and an insight into the products and sectors in the supply chain of the activity that carry the most substantial responsibility for the final waste generation or material demand footprints.




\section{Conclusions}\label{sec:conclusions}

T-reX is an extension to the open-source \texttt{brightway} ecosystem that enables users to calculate the waste and material footprints of any product or service in an LCA database. It `explodes' and reconstructs the database to identify and edit waste and material exchanges and writes matching custom `pseudo' LCIA methods. These exchanges are mirrored in the \texttt{brightway} project as `pseudo-biosphere' flows and thus, the waste and material footprints of any other supply chain flow of interest, such as water, gas, or critical raw materials, can be calculated similarly to existing LCIA methods.

T-reX elucidates the complex relationships between material demand, waste generation, and environmental impacts. This instrument enables detailed exploration of `footprints' and life cycle inventories---modelled externalities of human activities---and examines their connections to supply chain risks and potential environmental damage. T-reX is a step towards a better understanding of these interconnections for the practical realisation of `sustainability' and the `circular economy'.

% Back matter
\section*{Data availability}
All data used is publically available online under the noted sources. T-reX is fully open source and dedicated to the public domain under the CC-0 licence. It is installable via the Python Package Index (PyPI) under the name `T\_reX\_LCA' \url{https://pypi.org/project/T_reX_LCA}.
The full source code for T-reX is archived by Zenodo at \url{https://zenodo.org/records/10925359} and the development server is hosted by Github at \url{https://www.github.com/Stew-McD/T-reX}. A user guide with comprehensive documentation are presented at \url{https://T-reX.readthedocs.io}.

% \section*{CRediT authorship contribution statement} % STANDARD TEXTUAL VERSION
% \textbf{Stewart Charles McDowall:} Methodology, Software, Validation, Formal analysis, Investigation, Data curation, Writing - original draft, Writing - review \& editing, Visualization.
% \textbf{Elizabeth Lanphear:} Conceptualization, Methodology, Software, Validation, Writing - review \& editing.
% \textbf{Stefano Cucurachi:} Conceptualization, Writing - review \& editing, Supervision, Project administration, Funding acquisition.
% \textbf{Carlos Felipe Blanco:} Conceptualization, Writing - review \& editing, Supervision, Project administration, Funding acquisition.

\section*{CRediT authorship contribution statement} % VISUAL VERSION

\begin{itemize}[noitemsep]
    \item \textbf{SCM}: Stewart Charles McDowall
    \item \textbf{EL}: Elizabeth Lanphear
    \item \textbf{SC}: Stefano Cucurachi
    \item \textbf{CFB}: Carlos Felipe Blanco
\end{itemize}

\includegraphics[width=\columnwidth, height=7cm, keepaspectratio]{credit-TREX.pdf}

\section*{Declaration of competing interest}
  The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

\section*{Acknowledgements}
  Part of this research project was financially supported by the European Union's Horizon 2020 research and innovation programme under the grant agreement No. 101058522 (project FutuRaM --- futuram.eu). The authors would like to thank the reviewers for their valuable comments and suggestions.

  The authors would like to acknowledge those who were part of the futures thinking small group session at the FutuRaM consortium meeting in Berlin in June 2023 in which the term `T-reX/T(ool)-reX' was coined to name the vision presented by Stewart Charles McDowall of a comprehensive open-source software framework for the study and development of secondary raw material systems. The authors hope to continue the development of T-reX in the service of our shared ideals.


  %! replace the sections
\section{Supplementary material}\label{sec:supplementary}
  The supplementary material supplied with this manuscript contains the following:
    \begin{enumerate}
        \item Metadata of the T-reX Python package
        \item Details of the modules and user configuration
        \item Description of the computational workflow
        \item Modular flowchart of T-reX
        \item Example of the terminal output of T-reX
        \item Example of the terminal output of the case study
        \item Complete tabulated results of the case study
        \item Complete visualisations from the case study
    \end{enumerate}

%% Loading bibliography style file
%\bibliographystyle{model1-num-names}
\bibliographystyle{cas-model2-names}

% Loading bibliography database
\bibliography{cas-refs-TREX}

\end{document}

